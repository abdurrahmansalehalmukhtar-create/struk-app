<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Struk Transaksi</title>
  <style>
    @page { size: 58mm auto; margin: 0; }
    body {
      font-family: Arial, sans-serif;
      font-size: 10px; /* default font untuk semua */
      margin: 0;
      padding: 0;
      background: #fff;
    }
    .content {
      width: 100%;       /* diperbaiki supaya teks tidak kepotong */
      padding: 2px 3px;  /* dikurangi supaya pas kiri-kanan */
      margin: 0 auto;
      background: #fff;
      box-shadow: 0 0 10px #eee;
    }
    hr { border: 0; border-top: 1px dashed #000; margin: 5px 0; }
    .logo { display: block; margin: 0 auto 5px auto; }
    h3#NamaUsaha { /* khusus Nama Usaha */
      text-align: center;
      font-size: 12px;
      margin: 2px 0;
      font-weight: bold;
    }
    h3, p { text-align: center; margin: 2px 0; }
    .left { text-align: left; }
    pre, span, p, .left { 
      font-size: 10px; 
      white-space: pre-wrap;  /* teks panjang otomatis pindah baris */
      word-wrap: break-word;
    }

    /* Tombol download PDF */
    #linkDownloadPDF {
      display: block;
      text-align: center;
      margin: 5px;
      padding: 5px;
      background: #4CAF50;
      color: white;
      text-decoration: none;
      border-radius: 4px;
      font-size: 10px;
    }
  </style>
</head>
<body>
  <div class="content">
    <img class="logo" id="LogoUsaha" src="" alt="Logo Usaha" width="50" />
    <h3 id="NamaUsaha"></h3>
    <p id="AlamatUsaha"></p>
    <hr>
    <p class="left">Tanggal : <span id="Tanggal"></span></p>
    <p class="left">Kasir   : <span id="NamaPelanggan"></span></p>
    <p class="left">Metode  : <span id="MetodePembayaran"></span></p>
    <hr>
    <pre id="RincianCetak"></pre>
    <hr>
    <p class="left">TOTAL     : <span id="TotalTagihan"></span></p>
    <p class="left">DIBAYAR   : <span id="TotalPembayaran"></span></p>
    <p class="left">KEMBALIAN : <span id="Kembalian"></span></p>
    <hr>
    <p id="CatatanPenjualan"></p>
  </div>

  <!-- Tombol Download / Print PDF -->
  <a id="linkDownloadPDF" href="#">Download / Print PDF</a>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    const p = new URLSearchParams(window.location.search);
    document.getElementById('LogoUsaha').src          = p.get('LogoUsaha')          || "";
    document.getElementById('NamaUsaha').innerText    = p.get('NamaUsaha')          || "";
    document.getElementById('AlamatUsaha').innerText  = p.get('AlamatUsaha')        || "";
    document.getElementById('Tanggal').innerText      = p.get('Tanggal')            || "";
    document.getElementById('NamaPelanggan').innerText= p.get('NamaPelanggan')      || "";
    document.getElementById('MetodePembayaran').innerText = p.get('MetodePembayaran') || "";
    document.getElementById('RincianCetak').innerText = p.get('RincianCetak')       || "";
    document.getElementById('TotalTagihan').innerText = p.get('TotalTagihan')       || "";
    document.getElementById('TotalPembayaran').innerText = p.get('TotalPembayaran') || "";
    document.getElementById('Kembalian').innerText    = p.get('Kembalian')          || "";
    document.getElementById('CatatanPenjualan').innerText = p.get('CatatanPenjualan') || "";

    // Tombol download PDF
    const link = document.getElementById('linkDownloadPDF');
    link.addEventListener('click', () => {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({unit:'mm', format:[58, 200]}); // 58mm width
      doc.html(document.querySelector('.content'), {
        callback: function(pdf){
          pdf.save("Struk.pdf"); // otomatis download PDF
        },
        x:0,
        y:0,
        html2canvas: { scale: 0.5 }
      });
    });
  </script>
</body>
</html>
