<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Struk Transaksi</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      font-size: 10px;
      background: #f0f0f0;
      padding: 20px;
    }
    .struk {
      width: 58mm;
      background: #fff;
      padding: 3px 5px;
      margin: 0 auto;
      box-shadow: 0 0 5px #aaa;
    }
    h3, p { margin: 2px 0; text-align: center; }
    .left { text-align: left; }
    pre {
      font-size: 10px;
      white-space: pre-wrap;
      word-wrap: break-word;
      margin: 2px 0;
    }
    hr { border: 0; border-top: 1px dashed #000; margin: 3px 0; }
    .logo { display: block; margin: 0 auto 5px auto; width: 50px; }
  </style>
</head>
<body>

  <div class="struk" id="struk">
    <img class="logo" id="LogoUsaha" src="" alt="Logo Usaha">
    <h3 id="NamaUsaha"></h3>
    <p id="AlamatUsaha"></p>
    <hr>
    <p class="left">Tanggal : <span id="Tanggal"></span></p>
    <p class="left">Kasir   : <span id="NamaPelanggan"></span></p>
    <p class="left">Metode  : <span id="MetodePembayaran"></span></p>
    <hr>
    <pre id="RincianCetak"></pre>
    <hr>
    <p class="left">TOTAL     : <span id="TotalTagihan"></span></p>
    <p class="left">DIBAYAR   : <span id="TotalPembayaran"></span></p>
    <p class="left">KEMBALIAN : <span id="Kembalian"></span></p>
    <hr>
    <p id="CatatanPenjualan"></p>
  </div>

  <script>
    const p = new URLSearchParams(window.location.search);

    // Data AppSheet / default
    document.getElementById('LogoUsaha').src          = p.get('LogoUsaha')          || "https://via.placeholder.com/50";
    document.getElementById('NamaUsaha').innerText    = p.get('NamaUsaha')          || "Nama Usaha Contoh";
    document.getElementById('AlamatUsaha').innerText  = p.get('AlamatUsaha')        || "Jl. Contoh No.1, Kota Contoh";
    document.getElementById('Tanggal').innerText      = p.get('Tanggal')            || "21/09/2025";
    document.getElementById('NamaPelanggan').innerText= p.get('NamaPelanggan')      || "Budi";
    document.getElementById('MetodePembayaran').innerText = p.get('MetodePembayaran') || "Tunai";
    document.getElementById('RincianCetak').innerText = p.get('RincianCetak')       || 
`1x Nasi Goreng Spesial - 25.000
2x Ayam Goreng Crispy  - 40.000
3x Es Teh Manis        - 15.000
1x Air Mineral 600ml   - 5.000
1x Mie Goreng Telur    - 20.000`;
    document.getElementById('TotalTagihan').innerText = p.get('TotalTagihan')       || "105.000";
    document.getElementById('TotalPembayaran').innerText = p.get('TotalPembayaran') || "110.000";
    document.getElementById('Kembalian').innerText    = p.get('Kembalian')          || "5.000";
    document.getElementById('CatatanPenjualan').innerText = p.get('CatatanPenjualan') || "Terima kasih atas kunjungan Anda!";

    // Auto-generate PDF setelah halaman dibuka
    window.onload = function() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({
        unit: 'mm',
        format: [80, 200], // 58mm lebar sekitar 80px, panjang fleksibel
      });

      const struk = document.getElementById('struk');
      doc.html(struk, {
        callback: function(doc) {
          doc.save('struk.pdf'); // PDF siap dicetak
        },
        x: 0,
        y: 0,
        width: 58
      });
    };
  </script>

</body>
</html>


